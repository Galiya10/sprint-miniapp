<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∞–¥ –ü—Ä–∏–≤—ã—á–µ–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8f5e9 100%);
            color: #2d3436;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeIn 0.6s ease-in;
        }

        .logo {
            font-size: 60px;
            margin-bottom: 10px;
            animation: bounce 2s ease-in-out infinite;
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            color: #27ae60;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 14px;
            color: #636e72;
        }

        .add-habit {
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            animation: fadeIn 0.8s ease-in;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-size: 14px;
            color: #636e72;
            margin-bottom: 8px;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #dfe6e9;
            border-radius: 12px;
            font-size: 16px;
            transition: border 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #27ae60;
        }

        .btn {
            width: 100%;
            background: #27ae60;
            color: white;
            border: none;
            padding: 14px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
            transition: all 0.3s;
        }

        .btn:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .habits-list {
            animation: fadeIn 1s ease-in;
        }

        .habit-card {
            background: white;
            padding: 16px;
            border-radius: 16px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 12px;
            animation: slideIn 0.4s ease-out;
        }

        .habit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .habit-name {
            font-size: 18px;
            font-weight: 600;
            color: #2d3436;
        }

        .habit-day {
            font-size: 14px;
            color: #27ae60;
            font-weight: 600;
            background: #e8f5e9;
            padding: 4px 12px;
            border-radius: 20px;
        }

        .habit-progress {
            width: 100%;
            height: 8px;
            background: #dfe6e9;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .water-btn {
            width: 100%;
            background: #3498db;
            color: white;
            border: none;
            padding: 10px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .water-btn:hover {
            background: #2980b9;
        }

        .water-btn.watered {
            background: #95a5a6;
            cursor: not-allowed;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #636e72;
        }

        .empty-state .icon {
            font-size: 60px;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
        <div class="logo">ü¶•</div>
        <h1>–°–∞–¥ –ü—Ä–∏–≤—ã—á–µ–∫</h1>
        <div class="subtitle">–í—ã—Ä–∞—â–∏–≤–∞–π –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!</div>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏ -->
    <div class="add-habit">
        <div class="input-group">
            <label for="habitInput">–ö–∞–∫—É—é –ø—Ä–∏–≤—ã—á–∫—É —Ö–æ—á–µ—à—å –≤—ã—Ä–∞—Å—Ç–∏—Ç—å?</label>
            <input 
                type="text" 
                id="habitInput" 
                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω—É—Ç"
                maxlength="50"
            >
        </div>
        <button class="btn" onclick="addHabit()">üå± –ü–æ—Å–∞–¥–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É</button>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ -->
    <div class="habits-list" id="habitsList">
        <div class="empty-state">
            <div class="icon">üåø</div>
            <p>–¢–≤–æ–π —Å–∞–¥ –ø–æ–∫–∞ –ø—É—Å—Ç.<br>–ü–æ—Å–∞–¥–∏ –ø–µ—Ä–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É!</p>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ LocalStorage
        let habits = JSON.parse(localStorage.getItem('habits')) || [];

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        renderHabits();

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏
        function addHabit() {
            const input = document.getElementById('habitInput');
            const habitName = input.value.trim();

            if (habitName === '') {
                tg.showAlert('–í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏!');
                return;
            }

            // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É
            const newHabit = {
                id: Date.now(),
                name: habitName,
                day: 1,
                lastWatered: null,
                createdAt: new Date().toISOString()
            };

            habits.push(newHabit);
            localStorage.setItem('habits', JSON.stringify(habits));

            // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞
            input.value = '';

            // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
            renderHabits();

            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            tg.showPopup({
                message: `üå± –ü—Ä–∏–≤—ã—á–∫–∞ "${habitName}" –ø–æ—Å–∞–∂–µ–Ω–∞!`,
                buttons: [{type: 'ok'}]
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫
        function renderHabits() {
            const container = document.getElementById('habitsList');

            if (habits.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">üåø</div>
                        <p>–¢–≤–æ–π —Å–∞–¥ –ø–æ–∫–∞ –ø—É—Å—Ç.<br>–ü–æ—Å–∞–¥–∏ –ø–µ—Ä–≤—É—é –ø—Ä–∏–≤—ã—á–∫—É!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = habits.map(habit => {
                const progress = (habit.day / 30) * 100;
                const today = new Date().toDateString();
                const lastWatered = habit.lastWatered ? new Date(habit.lastWatered).toDateString() : null;
                const isWateredToday = lastWatered === today;

                return `
                    <div class="habit-card">
                        <div class="habit-header">
                            <div class="habit-name">${habit.name}</div>
                            <div class="habit-day">–î–µ–Ω—å ${habit.day}/30</div>
                        </div>
                        <div class="habit-progress">
                            <div class="progress-bar" style="width: ${progress}%"></div>
                        </div>
                        <button 
                            class="water-btn ${isWateredToday ? 'watered' : ''}" 
                            onclick="waterHabit(${habit.id})"
                            ${isWateredToday ? 'disabled' : ''}
                        >
                            ${isWateredToday ? '‚úÖ –ü–æ–ª–∏—Ç–æ —Å–µ–≥–æ–¥–Ω—è' : 'üíß –ü–æ–ª–∏—Ç—å'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–∏–≤–∞ –ø—Ä–∏–≤—ã—á–∫–∏
        function waterHabit(habitId) {
            const habit = habits.find(h => h.id === habitId);
            if (!habit) return;

            // –û–±–Ω–æ–≤–∏—Ç—å –¥–µ–Ω—å –∏ –¥–∞—Ç—É –ø–æ–ª–∏–≤–∞
            habit.day += 1;
            habit.lastWatered = new Date().toISOString();

            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç–∏–≥ –ª–∏ 30 –¥–Ω–µ–π
            if (habit.day > 30) {
                tg.showPopup({
                    message: `üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –ü—Ä–∏–≤—ã—á–∫–∞ "${habit.name}" —É–∫–æ—Ä–µ–Ω–∏–ª–∞—Å—å!`,
                    buttons: [{type: 'ok'}]
                });
                // –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å
            }

            localStorage.setItem('habits', JSON.stringify(habits));
            renderHabits();
        }

        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞ (–¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ë–î)
        function sendDataToBot() {
            tg.sendData(JSON.stringify({habits: habits}));
        }
    </script>
</body>
</html>
